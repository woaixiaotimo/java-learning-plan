
# 网站架构演进

单点应用

分布式面向服务架构(SOA)

微服务架构




# 单点应用

web应用大多使用传统的三层架构。

![](https://raw.githubusercontent.com/woaixiaotimo/img/master/20181205144409.png)


这个阶段一般网站用户量也不多，访问量都不大，数据量也不多，因此一般一台服务器就能搞定，应用程序，数据库和文件都可以部署在一台服务器上，架构图如下：

![](https://raw.githubusercontent.com/woaixiaotimo/img/master/20180307100110107.png)


如果项目较大，参与人数较多，易发生代码冲突。


# 分布式面向服务架构(SOA)


 SOA（Service Oriented Architecture）“面向服务的架构”:他是一种设计方法，其中包含多个服务， 服务之间通过相互依赖最终提供一系列的功能。一个服务 通常以独立的形式存在与操作系统进程中。各个服务之间 通过网络调用。


<!-- ![](https://raw.githubusercontent.com/woaixiaotimo/img/master/20181205150207.png) -->

![](https://raw.githubusercontent.com/woaixiaotimo/img/master/20180619101018799.png)


优点：代码复用，解耦，适用于大公司进行开发
缺点：网络延迟，整合困难，编码复杂


## SOA架构特点

系统集成：站在系统的角度，解决企业系统间的通信问 题，把原先散乱、无规划的系统间的网状结构，梳理成 规整、可治理的系统间星形结构，这一步往往需要引入 一些产品，比如 ESB、以及技术规范、服务管理规范； 这一步解决的核心问题是【有序】

系统的服务化：站在功能的角度，把业务逻辑抽象成 可复用、可组装的服务，通过服务的编排实现业务的 快速再生，目的：把原先固有的业务功能转变为通用 的业务服务，实现业务逻辑的快速复用；这一步解决 的核心问题是【复用】

业务的服务化：站在企业的角度，把企业职能抽象成 可复用、可组装的服务；把原先职能化的企业架构转变为服务化的企业架构，进一步提升企业的对外服务能力；“前面两步都是从技术层面来解决系统调用、系统功能复用的问题”。第三步，则是以业务驱动把一个业务单元封装成一项服务。这一步解决的核心问题是【高效】


## 相关问题

常用的rpc远程调用框架？

SpringCloud  
HttpClient  
dubbo

面向于服务架构通讯协议？
通常使用soap协议(http+xml)、http协议等，如webservice，http+json

# 微服务架构

微服务架构:其实和 SOA 架构类似,微服务是在 SOA 上做的升华，微服务架构强调的一个重点是“业务需要彻底的组件化和服务化”，原有的单个业务系统会拆分为多个可以独立开发、设计、运行的小应用。这些小应用之间通过服务完成交互和集成。

 **微服务架构 = 80%的SOA服务架构思想 + 100%的组件化架构思想 + 80%的领域建模思想**


 ## 微服务架构特点


1. **通过服务实现组件化**
    开发者不再需要协调其它服务部署对本服务的影响。


2. 按业务能力来划分服务和开发团队
    开发者可以自由选择开发技术，提供 API 服务


3. **去中心化**  
    每个微服务有自己私有的数据库持久化业务数据  
    每个微服务只能访问自己的数据库，而不能访问其它服务的数据库  
    某些业务场景下，需要在一个事务中更新多个数据库。这种情况也不能直接访问其它微服务的数据库，而是通过对于微服务进行操作。
    数据的去中心化，进一步降低了微服务之间的耦合度，不同服务可以采用不同的数据库技术（SQL、NoSQL等）。在复杂的业务场景下，如果包含多个微服务，通常在客户端或者中间层（网关）处理。


4. **基础设施自动化（devops、自动化部署）**

    Java EE部署架构，通过展现层打包WARs，业务层划分到JARs最后部署为EAR一个大包，而微服务则打开了这个黑盒子，把应用拆分成为一个一个的单个服务，应用Docker技术，不依赖任何服务器和数据模型，是一个全栈应用，可以通过自动化方式独立部署，每个服务运行在自己的进程中，通过轻量的通讯机制联系，经常是基于HTTP资源API，这些服务基于业务能力构建，能实现集中化管理（因为服务太多啦，不集中管理就无法DevOps啦）。

## 与SOA主要区别
| 功能 | SOA | 微服务 | 
| ---- | --- | ------ | 
|  组件大小  | 大块业务逻辑       | 单独任务或小块业务逻辑 |
|  耦合      | 通常松耦合         | 总是松耦合  |
|  公司架构   | 任何类型           | 小型、专注于功能交叉团队        |
|  管理       | 着重中央管理        | 着重分散管理 |
|  目标       | 确保应用能够交互操作 | 执行新功能、快速拓展开发团队 |